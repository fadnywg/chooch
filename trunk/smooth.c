/***************************************************************************
                          smooth.c  -  Smoothing with Savitsky-Golay filter
                             -------------------
    begin                : Sat Mar  9 09:51:02 GMT 2002
    copyright            : (C) 2002 by Gwyndaf Evans
    email                : gwyndaf@gwyndafevans.co.uk
 ***************************************************************************/

/***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/

#ifdef HAVE_CONFIG_H
#include <config.h>
#endif

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "chooch.h"



int smooth(int np, double *f, double *g, int nl, int nr, int m, int ld) {
  // 
  extern int verbose;
  int i, n, err, nc, index;
  float fpad[MAXSIZE];
  float cn[MAXCOEF];
  // Required by savgol
  float c[MAXCOEF];
  float cdata[]={ 
  0.00, -0.00,  1.00, -0.00,  0.00, // 2 2 0 4
  0.08, -0.67,  0.00,  0.67, -0.08, // 2 2 1 4
 -0.04,  0.67, -1.25,  0.67, -0.04, // 2 2 2 4
 -0.08,  0.17,  0.00, -0.17,  0.08, // 2 2 3 4
  0.02, -0.13,  0.32,  0.57,  0.32, -0.13,  0.02, // 3 3 0 4
  0.09, -0.27, -0.23,  0.00,  0.23,  0.27, -0.09, // 3 3 1 4
 -0.05,  0.25, -0.07, -0.27, -0.07,  0.25, -0.05, // 3 3 2 4
 -0.03,  0.03,  0.03,  0.00, -0.03, -0.03,  0.03, // 3 3 3 4
  0.03, -0.13,  0.07,  0.31,  0.42,  0.31,  0.07, -0.13,  0.03, // 4 4 0 4
  0.07, -0.12, -0.16, -0.11,  0.00,  0.11,  0.16,  0.12, -0.07,  // 4 4 1 4
 -0.04,  0.11,  0.04, -0.06, -0.11, -0.06,  0.04,  0.11, -0.04, // 4 4 2 4
 -0.01,  0.01,  0.01,  0.01,  0.00, -0.01, -0.01, -0.01,  0.01, // 4 4 3 4
  0.04, -0.10, -0.02,  0.14,  0.28,  0.33,  0.28,  0.14, -0.02, -0.10,  0.04, // nl=5 nr=5 ld=0 m=4
  0.06, -0.06, -0.10, -0.10, -0.06,  0.00,  0.06,  0.10,  0.10,  0.06, -0.06, // nl=5 nr=5 ld=1 m=4
 -0.03,  0.05,  0.04,  0.00, -0.04, -0.06, -0.04,  0.00,  0.04,  0.05, -0.03, // nl=5 nr=5 ld=2 m=4
 -0.01,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00,  0.01, // nl=5 nr=5 ld=3 m=4
  0.05, -0.08, -0.06,  0.05,  0.16,  0.25,  0.28,  0.25,  0.16,  0.05, -0.06, -0.08,  0.05, // nl=6 nr=6 ld=0 m=4
  0.05, -0.03, -0.07, -0.07, -0.06, -0.03,  0.00,  0.03,  0.06,  0.07,  0.07,  0.03, -0.05, // nl=6 nr=6 ld=1 m=4
 -0.02,  0.03,  0.03,  0.01, -0.01, -0.03, -0.03, -0.03, -0.01,  0.01,  0.03,  0.03, -0.02, // nl=6 nr=6 ld=2 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00, // nl=6 nr=6 ld=3 m=4
  0.05, -0.06, -0.06, -0.00,  0.08,  0.16,  0.22,  0.24,  0.22,  0.16,  0.08, -0.00, -0.06,
 -0.06,  0.05, // nl=7 nr=7 ld=0 m=4
  0.04, -0.01, -0.04, -0.05, -0.05, -0.04, -0.02,  0.00,  0.02,  0.04,  0.05,  0.05,  0.04,
  0.01, -0.04, // nl=7 nr=7 ld=1 m=4
 -0.01,  0.01,  0.02,  0.01,  0.00, -0.01, -0.02, -0.02, -0.02, -0.01,  0.00,  0.01,  0.02,
  0.01, -0.01, // nl=7 nr=7 ld=2 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
  0.00,  0.00, // nl=7 nr=7 ld=3 m=4
  0.05, -0.05, -0.06, -0.03,  0.03,  0.10,  0.16,  0.20,  0.21,  0.20,  0.16,  0.10,  0.03,
 -0.03, -0.06, -0.05,  0.05, // nl=8 nr=8 ld=0 m=4
  0.03, -0.00, -0.03, -0.04, -0.04, -0.04, -0.03, -0.02,  0.00,  0.02,  0.03,  0.04,  0.04,
  0.04,  0.03,  0.00, -0.03, // nl=8 nr=8 ld=1 m=4
 -0.01,  0.01,  0.01,  0.01,  0.01, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,  0.01,
  0.01,  0.01,  0.01, -0.01, // nl=8 nr=8 ld=2 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00,  0.00,  0.00, // nl=8 nr=8 ld=3 m=4
  0.05, -0.03, -0.06, -0.04,  0.00,  0.05,  0.11,  0.15,  0.18,  0.19,  0.18,  0.15,  0.11,
  0.05,  0.00, -0.04, -0.06, -0.03,  0.05, // nl=9 nr=9 ld=0 m=4
  0.03,  0.00, -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.01,  0.00,  0.01,  0.02,  0.03,
  0.03,  0.03,  0.03,  0.02, -0.00, -0.03, // nl=9 nr=9 ld=1 m=4
 -0.01,  0.00,  0.01,  0.01,  0.01,  0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
  0.00,  0.01,  0.01,  0.01,  0.00, -0.01, // nl=9 nr=9 ld=2 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00, // nl=9 nr=9 ld=3 m=4
  0.04, -0.02, -0.05, -0.04, -0.02,  0.02,  0.07,  0.11,  0.14,  0.16,  0.17,  0.16,  0.14,
  0.11,  0.07,  0.02, -0.02, -0.04, -0.05, -0.02,  0.04, // nl=10 nr=10 ld=0 m=4
  0.02,  0.00, -0.01, -0.02, -0.03, -0.03, -0.03, -0.02, -0.02, -0.01, -0.00,  0.01,  0.02,
  0.02,  0.03,  0.03,  0.03,  0.02,  0.01, -0.00, -0.02, // nl=10 nr=10 ld=1 m=4
 -0.01,  0.00,  0.01,  0.01,  0.01,  0.00,  0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.00, -0.01, // nl=10 nr=10 ld=2 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00, // nl=10 nr=10 ld=3 m=4
  0.04, -0.02, -0.04, -0.04, -0.03,  0.00,  0.04,  0.08,  0.11,  0.13,  0.15,  0.15,  0.15,
  0.13,  0.11,  0.08,  0.04,  0.00, -0.03, -0.04, -0.04, -0.02,  0.04, // nl=11 nr=11 ld=0 m=4
  0.02,  0.00, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01,  0.00,  0.01,
  0.01,  0.02,  0.02,  0.02,  0.02,  0.02,  0.02,  0.01, -0.00, -0.02, // nl=11 nr=11 ld=1 m=4
 -0.01,  0.00,  0.00,  0.01,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01,
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.01,  0.00,  0.00, -0.01, // nl=11 nr=11 ld=2 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00, // nl=11 nr=11 ld=3 m=4
  0.04, -0.01, -0.04, -0.04, -0.03, -0.01,  0.02,  0.05,  0.08,  0.11,  0.12,  0.14,  0.14,
  0.14,  0.12,  0.11,  0.08,  0.05,  0.02, -0.01, -0.03, -0.04, -0.04, -0.01,  0.04, // nl=12 nr=12 ld=0 m=4
  0.02,  0.00, -0.00, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.00,  0.00,
  0.00,  0.01,  0.01,  0.02,  0.02,  0.02,  0.02,  0.02,  0.01,  0.00, -0.00, -0.02, // nl=12 nr=12 ld=1 m=4
 -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, // nl=12 nr=12 ld=2 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00, // nl=12 nr=12 ld=3 m=4
  0.04, -0.01, -0.03, -0.04, -0.03, -0.02,  0.01,  0.03,  0.06,  0.08,  0.10,  0.12,  0.13,
  0.13,  0.13,  0.12,  0.10,  0.08,  0.06,  0.03,  0.01, -0.02, -0.03, -0.04, -0.03, -0.01,
  0.04, // nl=13 nr=13 ld=0 m=4
  0.02,  0.01, -0.00, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.00,
  0.00,  0.00,  0.01,  0.01,  0.01,  0.02,  0.02,  0.02,  0.02,  0.01,  0.01,  0.00, -0.01,
 -0.02, // nl=13 nr=13 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00,
 -0.00, // nl=13 nr=13 ld=2 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,
  0.00, // nl=13 nr=13 ld=3 m=4
  0.04, -0.00, -0.03, -0.04, -0.03, -0.02, -0.00,  0.02,  0.04,  0.06,  0.08,  0.10,  0.11,
  0.12,  0.12,  0.12,  0.11,  0.10,  0.08,  0.06,  0.04,  0.02, -0.00, -0.02, -0.03, -0.04,
 -0.03, -0.00,  0.04, // nl=14 nr=14 ld=0 m=4
  0.01,  0.01, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.00, -0.00,  0.00,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,
  0.00, -0.01, -0.01, // nl=14 nr=14 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00, -0.00, -0.00, // nl=14 nr=14 ld=2 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
  0.00,  0.00,  0.00, // nl=14 nr=14 ld=3 m=4
  0.04, -0.00, -0.02, -0.03, -0.03, -0.03, -0.01,  0.01,  0.02,  0.04,  0.06,  0.08,  0.09,
  0.11,  0.11,  0.11,  0.11,  0.11,  0.09,  0.08,  0.06,  0.04,  0.02,  0.01, -0.01, -0.03,
 -0.03, -0.03, -0.02, -0.00,  0.04, // nl=15 nr=15 ld=0 m=4
  0.01,  0.01, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,
  0.01,  0.00,  0.00, -0.01, -0.01, // nl=15 nr=15 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00, -0.00, -0.00, // nl=15 nr=15 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00,  0.00,  0.00,  0.00,  0.00, // nl=15 nr=15 ld=3 m=4
  0.04,  0.00, -0.02, -0.03, -0.03, -0.03, -0.02, -0.00,  0.01,  0.03,  0.05,  0.06,  0.08,
  0.09,  0.10,  0.11,  0.11,  0.11,  0.10,  0.09,  0.08,  0.06,  0.05,  0.03,  0.01, -0.00,
 -0.02, -0.03, -0.03, -0.03, -0.02,  0.00,  0.04, // nl=16 nr=16 ld=0 m=4
  0.01,  0.01,  0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.00, -0.00, -0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,
  0.01,  0.01,  0.01,  0.00, -0.00, -0.01, -0.01, // nl=16 nr=16 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, // nl=16 nr=16 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00, // nl=16 nr=16 ld=3 m=4
  0.04,  0.00, -0.02, -0.03, -0.03, -0.03, -0.02, -0.01,  0.01,  0.02,  0.04,  0.05,  0.07,
  0.08,  0.09,  0.09,  0.10,  0.10,  0.10,  0.09,  0.09,  0.08,  0.07,  0.05,  0.04,  0.02,
  0.01, -0.01, -0.02, -0.03, -0.03, -0.03, -0.02,  0.00,  0.04, // nl=17 nr=17 ld=0 m=4
  0.01,  0.00,  0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.01, -0.00, -0.00, -0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,
  0.01,  0.01,  0.01,  0.01,  0.01,  0.00, -0.00, -0.00, -0.01, // nl=17 nr=17 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, // nl=17 nr=17 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00, // nl=17 nr=17 ld=3 m=4
  0.03,  0.01, -0.01, -0.02, -0.03, -0.03, -0.02, -0.01, -0.00,  0.01,  0.03,  0.04,  0.05,
  0.06,  0.08,  0.08,  0.09,  0.09,  0.10,  0.09,  0.09,  0.08,  0.08,  0.06,  0.05,  0.04,
  0.03,  0.01, -0.00, -0.01, -0.02, -0.03, -0.03, -0.02, -0.01,  0.01,  0.03, // nl=18 nr=18 ld=0 m=4
  0.01,  0.00,  0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.01,
  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.00,  0.00, -0.00, -0.00, -0.01, // nl=18 nr=18 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, // nl=18 nr=18 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00, // nl=18 nr=18 ld=3 m=4
  0.03,  0.01, -0.01, -0.02, -0.03, -0.03, -0.02, -0.02, -0.01,  0.01,  0.02,  0.03,  0.04,
  0.05,  0.06,  0.07,  0.08,  0.09,  0.09,  0.09,  0.09,  0.09,  0.08,  0.07,  0.06,  0.05,
  0.04,  0.03,  0.02,  0.01, -0.01, -0.02, -0.02, -0.03, -0.03, -0.02, -0.01,  0.01,  0.03, // nl=19 nr=19 ld=0 m=4
  0.01,  0.00,  0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.01,  0.01,
  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.00,  0.00,  0.00, -0.00, -0.00, -0.01, // nl=19 nr=19 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, // nl=19 nr=19 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00, // nl=19 nr=19 ld=3 m=4
  0.03,  0.01, -0.01, -0.02, -0.02, -0.03, -0.02, -0.02, -0.01,  0.00,  0.01,  0.02,  0.03,
  0.04,  0.05,  0.06,  0.07,  0.08,  0.08,  0.09,  0.09,  0.09,  0.08,  0.08,  0.07,  0.06,
  0.05,  0.04,  0.03,  0.02,  0.01,  0.00, -0.01, -0.02, -0.02, -0.03, -0.02, -0.02, -0.01,
  0.01,  0.03, // nl=20 nr=20 ld=0 m=4
  0.01,  0.00,  0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.01,
  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.00,  0.00,  0.00, -0.00,
 -0.00, -0.01, // nl=20 nr=20 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
 -0.00, -0.00, // nl=20 nr=20 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, // nl=20 nr=20 ld=3 m=4
  0.03,  0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.00,  0.01,  0.02,  0.03,
  0.04,  0.05,  0.05,  0.06,  0.07,  0.07,  0.08,  0.08,  0.08,  0.08,  0.08,  0.07,  0.07,
  0.06,  0.05,  0.05,  0.04,  0.03,  0.02,  0.01, -0.00, -0.01, -0.02, -0.02, -0.02, -0.02,
 -0.02, -0.01,  0.01,  0.03, // nl=21 nr=21 ld=0 m=4
  0.01,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.00,  0.00,  0.00,
  0.00, -0.00, -0.00, -0.01, // nl=21 nr=21 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, // nl=21 nr=21 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,
  0.00,  0.00,  0.00,  0.00, // nl=21 nr=21 ld=3 m=4
  0.03,  0.01, -0.00, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01,  0.00,  0.01,  0.02,
  0.03,  0.04,  0.05,  0.05,  0.06,  0.07,  0.07,  0.08,  0.08,  0.08,  0.08,  0.08,  0.07,
  0.07,  0.06,  0.05,  0.05,  0.04,  0.03,  0.02,  0.01,  0.00, -0.01, -0.01, -0.02, -0.02,
 -0.02, -0.02, -0.01, -0.00,  0.01,  0.03, // nl=22 nr=22 ld=0 m=4
  0.01,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, -0.01, // nl=22 nr=22 ld=1 m=4
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, // nl=22 nr=22 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00,  0.00,  0.00,  0.00,  0.00,  0.00, // nl=22 nr=22 ld=3 m=4
  0.03,  0.01, -0.00, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.00,  0.00,  0.01,
  0.02,  0.03,  0.04,  0.05,  0.05,  0.06,  0.07,  0.07,  0.07,  0.07,  0.07,  0.07,  0.07,
  0.07,  0.07,  0.06,  0.05,  0.05,  0.04,  0.03,  0.02,  0.01,  0.00, -0.00, -0.01, -0.02,
 -0.02, -0.02, -0.02, -0.02, -0.01, -0.00,  0.01,  0.03, // nl=23 nr=23 ld=0 m=4
  0.01,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
 -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  0.00,
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.01, // nl=23 nr=23 ld=1 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, // nl=23 nr=23 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00, // nl=23 nr=23 ld=3 m=4
  0.03,  0.01, -0.00, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01,  0.00,  0.01,
  0.02,  0.02,  0.03,  0.04,  0.05,  0.05,  0.06,  0.06,  0.07,  0.07,  0.07,  0.07,  0.07,
  0.07,  0.07,  0.06,  0.06,  0.05,  0.05,  0.04,  0.03,  0.02,  0.02,  0.01,  0.00, -0.01,
 -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.00,  0.01,  0.03, // nl=24 nr=24 ld=0 m=4
  0.01,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01,
 -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.01,  0.01,  0.01,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.01, // nl=24 nr=24 ld=1 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, // nl=24 nr=24 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, // nl=24 nr=24 ld=3 m=4
  0.03,  0.01, -0.00, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.00,  0.00,
  0.01,  0.02,  0.03,  0.03,  0.04,  0.05,  0.05,  0.06,  0.06,  0.06,  0.07,  0.07,  0.07,
  0.07,  0.07,  0.06,  0.06,  0.06,  0.05,  0.05,  0.04,  0.03,  0.03,  0.02,  0.01,  0.00,
 -0.00, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.00,  0.01,  0.03, // nl=25 nr=25 ld=0 m=4
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, // nl=25 nr=25 ld=1 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, // nl=25 nr=25 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, // nl=25 nr=25 ld=3 m=4
  0.03,  0.01,  0.00, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.00,  0.00,
  0.01,  0.01,  0.02,  0.03,  0.03,  0.04,  0.05,  0.05,  0.06,  0.06,  0.06,  0.06,  0.07,
  0.07,  0.07,  0.06,  0.06,  0.06,  0.06,  0.05,  0.05,  0.04,  0.03,  0.03,  0.02,  0.01,
  0.01,  0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01,  0.00,  0.01,
  0.03, // nl=26 nr=26 ld=0 m=4
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00,
 -0.00, // nl=26 nr=26 ld=1 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00,
 -0.00, // nl=26 nr=26 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00, // nl=26 nr=26 ld=3 m=4
  0.03,  0.01,  0.00, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.00,
  0.00,  0.01,  0.02,  0.02,  0.03,  0.04,  0.04,  0.05,  0.05,  0.05,  0.06,  0.06,  0.06,
  0.06,  0.06,  0.06,  0.06,  0.06,  0.06,  0.05,  0.05,  0.05,  0.04,  0.04,  0.03,  0.02,
  0.02,  0.01,  0.00, -0.00, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01,
  0.00,  0.01,  0.03, // nl=27 nr=27 ld=0 m=4
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, -0.00,
 -0.00, -0.00, -0.00, // nl=27 nr=27 ld=1 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
 -0.00, -0.00, -0.00, // nl=27 nr=27 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00, // nl=27 nr=27 ld=3 m=4
  0.03,  0.01,  0.00, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.00,
  0.00,  0.01,  0.01,  0.02,  0.02,  0.03,  0.04,  0.04,  0.05,  0.05,  0.05,  0.06,  0.06,
  0.06,  0.06,  0.06,  0.06,  0.06,  0.06,  0.06,  0.05,  0.05,  0.05,  0.04,  0.04,  0.03,
  0.02,  0.02,  0.01,  0.01,  0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02,
 -0.01, -0.01,  0.00,  0.01,  0.03, // nl=28 nr=28 ld=0 m=4
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00, -0.00, -0.00, -0.00, -0.00, // nl=28 nr=28 ld=1 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, // nl=28 nr=28 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00, // nl=28 nr=28 ld=3 m=4
  0.03,  0.01,  0.00, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01,
 -0.00,  0.00,  0.01,  0.01,  0.02,  0.03,  0.03,  0.04,  0.04,  0.04,  0.05,  0.05,  0.05,
  0.06,  0.06,  0.06,  0.06,  0.06,  0.06,  0.06,  0.05,  0.05,  0.05,  0.04,  0.04,  0.04,
  0.03,  0.03,  0.02,  0.01,  0.01,  0.00, -0.00, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02,
 -0.02, -0.01, -0.01, -0.01,  0.00,  0.01,  0.03, // nl=29 nr=29 ld=0 m=4
  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, // nl=29 nr=29 ld=1 m=4
 -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, // nl=29 nr=29 ld=2 m=4
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,
  0.00,  0.00,  0.00,  0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
 -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00, // nl=29 nr=29 ld=3 m=4
  };
  //
  if(verbose>1)printf("nl = %d     nr = %d     ld = %d     m = %d\n", nl, nr, ld, m);
  nc=nl+nr+1;
  pad(np, nl, nr, f, fpad);
  /* Find array index at which to read SavGol coefficients */
  index=0;
  for(i=2;i<nr;++i){
     index+=4*(i+i+1);
  }
  index+=ld*(i+i+1); // Choose coefficients for correct derivative

  printf("nl=%d nr=%d ld=%d m=%d\n", nl, nr, ld, m);
  for(i=0;i<nc;++i,++index){
     cn[i]=cdata[index];
     printf(" %5.2f ",cn[i]);
  }
  printf("\n");
  apply_coeffs(fpad, g, cn, nl, nr, np);
  if(verbose>0)printf("Done smoothing\n");
  return 0;
}

void pad(int np, int nl, int nr, double *fin, float *fout) {
  extern int verbose;
  int i;
  if(verbose>0)printf("Padding input spectrum\n");
  for (i = 0; i < nl; i++) {
    fout[i] = (float) fin[0];
  }
  for (i = nl; i < (np+nl); i++) {
    fout[i] = (float) fin[i-nl];
  }
  for (i = (np+nl); i < (nl+np+nr); i++) {
    fout[i] = (float) fin[np-1];
  }
}

int apply_coeffs(float *fpad, double *g, float *cn, int nl, int nr, int np) {
  extern int verbose;
  int i, n;
  if(verbose>0)printf("Applying SavGol coeffs\n");
  for (i = 0; i < np; i++) {
    g[i] = 0.0;
    for (n = 0; n < (nl+nr+1); n++) {
      g[i] += (double) (cn[n] * fpad[i+n]);
    }
  }
  return 0;
}

int unwrap(float *cin, float *cout, int np, int nl, int nr) {
  int i, k = 0;
  int nc;
  /*
  float totc=0.0; 
  */
  /*
   * e.g. for nl=4 and nr=4 
   * out k: c[0]  c[1]  c[2]  c[3]  c[4]  c[5]  c[6]    c[7]    c[8]
   * co     c-4   c-3   c-2   c-1   c0    c1    c2      c3      c4
   * in  i: c[5]  c[4]  c[3]  c[2]  c[1]  c[np] c[np-1] c[np-2] c[n-3]
   */
  nc = nl+nr+1;
  /*  for (i = 1; i <= np; i++) {
   *    printf("%s %7.3f %s ", (i==0)?"cin: ":"", cin[i], (i==(np))?"\n":"");
   *  } 
   */
  cout[k] = cin[nl+1];
  for (k = 1, i = (nl); i > 0; i--, k++) {
    cout[k] = cin[i];
  }
  for (k = (nl+1), i = np; i >= (np-nr+1); i--, k++) {
    cout[k] = cin[i];
  }
  /*
  for (k = 0; k < nc; k++) {
     printf("%s %7.3f %s ", (k==0)?"cout: ":"", cout[k], (k==(nc-1))?"\n":"");
     totc += cout[k];
  }
  if (!(totc == 1.000)) {
  printf("ERROR: Sum of cout should = 1.0;  actual value = %10.8f\n", totc);
	exit (EXIT_FAILURE);
  }
  */
  return 0;
}




